

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Univariate time series classification with sktime &mdash; sktime 0.4.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/fields.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/sktime-favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Multivariate time series classification with sktime" href="03_classification_multivariate.html" />
    <link rel="prev" title="Forecasting with sktime" href="01_forecasting.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> sktime
          

          
          </a>

          
            
            
              <div class="version">
                0.4.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../how_to_get_started.html">How to get started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_forecasting.html">Forecasting with sktime</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Univariate time series classification with sktime</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Preliminaries">Preliminaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Load-data">Load data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Data-representation">Data representation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Why-not-just-use-scikit-learn?">Why not just use scikit-learn?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Reduction:-from-time-series-classification-to-tabular-classification">Reduction: from time-series classification to tabular classification</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Time-series-classification-with-sktime">Time series classification with sktime</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Time-series-forest">Time series forest</a></li>
<li class="toctree-l4"><a class="reference internal" href="#RISE">RISE</a></li>
<li class="toctree-l4"><a class="reference internal" href="#K-nearest-neighbours-classifier-for-time-series">K-nearest-neighbours classifier for time series</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Other-classifiers">Other classifiers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Extra-resources">Extra resources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Multivariate-time-series-classification">Multivariate time series classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Cutting-edge-research-and-benchmarking">Cutting-edge research and benchmarking</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Deep-learning">Deep learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Time-series-regression">Time series regression</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="03_classification_multivariate.html">Multivariate time series classification with sktime</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_benchmarking.html">Benchmarking with sktime</a></li>
<li class="toctree-l2"><a class="reference internal" href="feature_extraction_with_tsfresh.html">Feature extraction with tsfresh transformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="shapelet_transform.html">Shapelets and the Shapelet Transform with sktime</a></li>
<li class="toctree-l2"><a class="reference internal" href="mrseql.html">Time series classification with Mr-SEQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="rocket.html">Demo of ROCKET transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="plateau_finder.html">Demo of the PlateauFinder transformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="loading_data.html">Loading data in sktime</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how_to_contribute.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code_of_conduct.html">Code of Conduct</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sktime</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../how_to_get_started.html">How to get started</a> &raquo;</li>
        
      <li>Univariate time series classification with sktime</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p><a class="reference external" href="https://mybinder.org/v2/gh/alan-turing-institute/sktime/master?filepath=examples/02_classification_univariate.ipynb"><img alt="binder" src="https://mybinder.org/badge_logo.svg" /></a></p>
<div class="section" id="Univariate-time-series-classification-with-sktime">
<h1>Univariate time series classification with sktime<a class="headerlink" href="#Univariate-time-series-classification-with-sktime" title="Permalink to this headline">¶</a></h1>
<p>In this notebook, we will use sktime for univariate time series classification. Here, we have a single time series variable and an associated label for multiple instances. The goal is to find a classifier that can learn the relationship between time series and label and accurately predict the label of new series.</p>
<p>When you have multiple time series variables and want to learn the relationship between them and a label, you can take a look at our <a class="reference external" href="https://github.com/alan-turing-institute/sktime/blob/master/examples/03_classification_multivariate.ipynb">multivariate time series classification notebook</a>.</p>
<div class="section" id="Preliminaries">
<h2>Preliminaries<a class="headerlink" href="#Preliminaries" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">FunctionTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sktime.classification.compose</span> <span class="kn">import</span> <span class="n">TimeSeriesForestClassifier</span>
<span class="kn">from</span> <span class="nn">sktime.classification.distance_based</span> <span class="kn">import</span> <span class="n">KNeighborsTimeSeriesClassifier</span>
<span class="kn">from</span> <span class="nn">sktime.datasets</span> <span class="kn">import</span> <span class="n">load_arrow_head</span>
<span class="kn">from</span> <span class="nn">sktime.series_as_features.compose</span> <span class="kn">import</span> <span class="n">FeatureUnion</span>
<span class="kn">from</span> <span class="nn">sktime.transformers.series_as_features.compose</span> <span class="kn">import</span> <span class="n">RowTransformer</span>
<span class="kn">from</span> <span class="nn">sktime.transformers.series_as_features.reduce</span> <span class="kn">import</span> <span class="n">Tabularizer</span>
<span class="kn">from</span> <span class="nn">sktime.transformers.series_as_features.segment</span> <span class="kn">import</span> \
    <span class="n">RandomIntervalSegmenter</span>
<span class="kn">from</span> <span class="nn">sktime.utils.time_series</span> <span class="kn">import</span> <span class="n">time_series_slope</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.ar_model</span> <span class="kn">import</span> <span class="n">AutoReg</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">acf</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Load-data">
<h2>Load data<a class="headerlink" href="#Load-data" title="Permalink to this headline">¶</a></h2>
<p>In this notebook, we use the <a class="reference external" href="https://timeseriesclassification.com/description.php?Dataset=ArrowHead">arrow head problem</a>.</p>
<p>The arrowhead dataset consists of outlines of the images of arrow heads. The classification of projectile points is an important topic in anthropology. The classes are based on shape distinctions such as the presence and location of a notch in the arrow.</p>
<p><img alt="arrow heads" class="no-scaled-link" src="../_images/arrow-heads.png" style="width: 400px;" /></p>
<p>The shapes of the projectile points are converted into a sequence using the angle-based method as described in this <a class="reference external" href="https://izbicki.me/blog/converting-images-into-time-series-for-data-mining.html">blog post</a> about converting images into time series for data mining.</p>
<p><img alt="from shapes to time series" class="no-scaled-link" src="../_images/from-shapes-to-time-series.png" style="width: 400px;" /></p>
<div class="section" id="Data-representation">
<h3>Data representation<a class="headerlink" href="#Data-representation" title="Permalink to this headline">¶</a></h3>
<p>Throughout sktime, the expected data format is a <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>, but in a slighly unusual format. A single column can contain not only primitives (floats, integers or strings), but also entire time series in form of a <code class="docutils literal notranslate"><span class="pre">pd.Series</span></code> or <code class="docutils literal notranslate"><span class="pre">np.array</span></code>.</p>
<p>For more details on our choice of data container, see this <a class="reference external" href="https://github.com/alan-turing-institute/sktime/wiki/Time-series-data-container">wiki entry</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_arrow_head</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(158, 1) (158,) (53, 1) (53,)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># univariate time series input data</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dim_0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>0     -2.1448
1     -2.1654
2     -2.1562
3   ...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0     -1.7170
1     -1.7281
2     -1.6833
3   ...</td>
    </tr>
    <tr>
      <th>60</th>
      <td>0     -1.9674
1     -1.9672
2     -1.9512
3   ...</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0     -1.6737
1     -1.6715
2     -1.6602
3   ...</td>
    </tr>
    <tr>
      <th>133</th>
      <td>0     -2.4343
1     -2.4315
2     -2.3426
3   ...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># binary target variable</span>
<span class="n">labels</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;0&#39; &#39;1&#39; &#39;2&#39;] [62 51 45]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figaspect</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">))</span>
<span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
    <span class="n">X_train</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">y_train</span> <span class="o">==</span> <span class="n">label</span><span class="p">,</span> <span class="s2">&quot;dim_0&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;class </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Example time series&quot;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_02_classification_univariate_8_0.png" src="../_images/examples_02_classification_univariate_8_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Why-not-just-use-scikit-learn?">
<h2>Why not just use scikit-learn?<a class="headerlink" href="#Why-not-just-use-scikit-learn?" title="Permalink to this headline">¶</a></h2>
<p>We can still use scikit-learn, but using scikit-learn comes with some implicit modelling choices.</p>
<div class="section" id="Reduction:-from-time-series-classification-to-tabular-classification">
<h3>Reduction: from time-series classification to tabular classification<a class="headerlink" href="#Reduction:-from-time-series-classification-to-tabular-classification" title="Permalink to this headline">¶</a></h3>
<p>To use scikit-learn, we have to convert the data into the required tabular format. There are different ways we can do that:</p>
<div class="section" id="Treating-time-points-as-separate-features-(tabularisation)">
<h4>Treating time points as separate features (tabularisation)<a class="headerlink" href="#Treating-time-points-as-separate-features-(tabularisation)" title="Permalink to this headline">¶</a></h4>
<p>Alternatively, we could bin and aggregate observations in time bins of different length.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sktime.utils.data_container</span> <span class="kn">import</span> <span class="n">tabularize</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="n">X_train_tab</span> <span class="o">=</span> <span class="n">tabularize</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_tab</span> <span class="o">=</span> <span class="n">tabularize</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">X_train_tab</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dim_0__0</th>
      <th>dim_0__1</th>
      <th>dim_0__2</th>
      <th>dim_0__3</th>
      <th>dim_0__4</th>
      <th>dim_0__5</th>
      <th>dim_0__6</th>
      <th>dim_0__7</th>
      <th>dim_0__8</th>
      <th>dim_0__9</th>
      <th>...</th>
      <th>dim_0__241</th>
      <th>dim_0__242</th>
      <th>dim_0__243</th>
      <th>dim_0__244</th>
      <th>dim_0__245</th>
      <th>dim_0__246</th>
      <th>dim_0__247</th>
      <th>dim_0__248</th>
      <th>dim_0__249</th>
      <th>dim_0__250</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>-2.1448</td>
      <td>-2.1654</td>
      <td>-2.1562</td>
      <td>-2.0793</td>
      <td>-2.0127</td>
      <td>-1.9173</td>
      <td>-1.8389</td>
      <td>-1.8199</td>
      <td>-1.7316</td>
      <td>-1.6151</td>
      <td>...</td>
      <td>-1.6380</td>
      <td>-1.7356</td>
      <td>-1.7800</td>
      <td>-1.8875</td>
      <td>-1.9278</td>
      <td>-1.9802</td>
      <td>-2.0476</td>
      <td>-2.0384</td>
      <td>-2.0468</td>
      <td>-2.0995</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-1.7170</td>
      <td>-1.7281</td>
      <td>-1.6833</td>
      <td>-1.6668</td>
      <td>-1.6468</td>
      <td>-1.5915</td>
      <td>-1.5638</td>
      <td>-1.5561</td>
      <td>-1.5038</td>
      <td>-1.4455</td>
      <td>...</td>
      <td>-1.4566</td>
      <td>-1.5092</td>
      <td>-1.5394</td>
      <td>-1.5817</td>
      <td>-1.6159</td>
      <td>-1.6515</td>
      <td>-1.6988</td>
      <td>-1.7153</td>
      <td>-1.7320</td>
      <td>-1.7176</td>
    </tr>
    <tr>
      <th>60</th>
      <td>-1.9674</td>
      <td>-1.9672</td>
      <td>-1.9512</td>
      <td>-1.9138</td>
      <td>-1.8754</td>
      <td>-1.8163</td>
      <td>-1.7921</td>
      <td>-1.7639</td>
      <td>-1.7257</td>
      <td>-1.6843</td>
      <td>...</td>
      <td>-1.6493</td>
      <td>-1.6650</td>
      <td>-1.7102</td>
      <td>-1.7297</td>
      <td>-1.7641</td>
      <td>-1.8069</td>
      <td>-1.8527</td>
      <td>-1.9121</td>
      <td>-1.9486</td>
      <td>-1.9507</td>
    </tr>
    <tr>
      <th>32</th>
      <td>-1.6737</td>
      <td>-1.6715</td>
      <td>-1.6602</td>
      <td>-1.6349</td>
      <td>-1.6061</td>
      <td>-1.5588</td>
      <td>-1.5562</td>
      <td>-1.5173</td>
      <td>-1.4901</td>
      <td>-1.4263</td>
      <td>...</td>
      <td>-1.4081</td>
      <td>-1.4331</td>
      <td>-1.4963</td>
      <td>-1.5221</td>
      <td>-1.5602</td>
      <td>-1.5768</td>
      <td>-1.6097</td>
      <td>-1.6362</td>
      <td>-1.6612</td>
      <td>-1.6625</td>
    </tr>
    <tr>
      <th>133</th>
      <td>-2.4343</td>
      <td>-2.4315</td>
      <td>-2.3426</td>
      <td>-2.2252</td>
      <td>-2.1012</td>
      <td>-2.0793</td>
      <td>-1.9727</td>
      <td>-1.8580</td>
      <td>-1.7973</td>
      <td>-1.6430</td>
      <td>...</td>
      <td>-1.9316</td>
      <td>-2.0513</td>
      <td>-2.1364</td>
      <td>-2.1918</td>
      <td>-2.2625</td>
      <td>-2.3576</td>
      <td>-2.4040</td>
      <td>-2.4596</td>
      <td>-2.4922</td>
      <td>-2.4644</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 251 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># let&#39;s get a baseline for comparison</span>
<span class="kn">from</span> <span class="nn">sklearn.dummy</span> <span class="kn">import</span> <span class="n">DummyClassifier</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">DummyClassifier</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;prior&quot;</span><span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_tab</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_tab</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.3584905660377358
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># now we can apply any scikit-learn classifier</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_tab</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_tab</span><span class="p">)</span>
<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.8113207547169812
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># with sktime, we can write this as a pipeline</span>
<span class="kn">from</span> <span class="nn">sktime.transformers.series_as_features.reduce</span> <span class="kn">import</span> <span class="n">Tabularizer</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>

<span class="n">classifier</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">Tabularizer</span><span class="p">(),</span> <span class="n">RandomForestClassifier</span><span class="p">())</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.8301886792452831
</pre></div></div>
</div>
<p>What’s the implicit modelling choice here?</p>
<blockquote>
<div><p>We treat each observation as a separate feature and thus ignore they are ordered in time. A tabular algorithm cannot make use of the fact that features are ordered in time, i.e. if we changed the order of the features, the fitted model and predictions wouldn’t change. Sometimes this works well, sometimes it doesn’t.</p>
</div></blockquote>
</div>
<div class="section" id="Feature-extraction">
<h4>Feature extraction<a class="headerlink" href="#Feature-extraction" title="Permalink to this headline">¶</a></h4>
<p>Another modelling choice: we could extract features from the time series and then use the features to fit our tabular classifier. Here we use <a class="reference external" href="https://tsfresh.readthedocs.io">tsfresh</a> for automatic feature extraction.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sktime.transformers.series_as_features.summarize</span> <span class="kn">import</span> <span class="n">TSFreshFeatureExtractor</span>

<span class="n">transformer</span> <span class="o">=</span> <span class="n">TSFreshFeatureExtractor</span><span class="p">(</span><span class="n">default_fc_parameters</span><span class="o">=</span><span class="s2">&quot;minimal&quot;</span><span class="p">)</span>
<span class="n">extracted_features</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">extracted_features</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/travis/build/alan-turing-institute/sktime/sktime/transformers/series_as_features/summarize/_tsfresh.py:150: UserWarning: Found non-unique index, replaced with unique index.
  warn(&#34;Found non-unique index, replaced with unique index.&#34;)
Feature Extraction: 100%|██████████| 5/5 [00:00&lt;00:00, 55.81it/s]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>variable</th>
      <th>dim_0__length</th>
      <th>dim_0__maximum</th>
      <th>dim_0__mean</th>
      <th>dim_0__median</th>
      <th>dim_0__minimum</th>
      <th>dim_0__standard_deviation</th>
      <th>dim_0__sum_values</th>
      <th>dim_0__variance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>251.0</td>
      <td>1.7804</td>
      <td>-1.462151e-06</td>
      <td>0.063970</td>
      <td>-2.1654</td>
      <td>0.998005</td>
      <td>-0.000367</td>
      <td>0.996014</td>
    </tr>
    <tr>
      <th>1</th>
      <td>251.0</td>
      <td>1.3186</td>
      <td>-1.952191e-07</td>
      <td>0.097100</td>
      <td>-1.7320</td>
      <td>0.998006</td>
      <td>-0.000049</td>
      <td>0.996017</td>
    </tr>
    <tr>
      <th>2</th>
      <td>251.0</td>
      <td>1.5382</td>
      <td>1.227092e-06</td>
      <td>-0.012606</td>
      <td>-1.9674</td>
      <td>0.998003</td>
      <td>0.000308</td>
      <td>0.996010</td>
    </tr>
    <tr>
      <th>3</th>
      <td>251.0</td>
      <td>1.1377</td>
      <td>-1.418327e-06</td>
      <td>0.312720</td>
      <td>-1.6737</td>
      <td>0.998003</td>
      <td>-0.000356</td>
      <td>0.996011</td>
    </tr>
    <tr>
      <th>4</th>
      <td>251.0</td>
      <td>2.0725</td>
      <td>8.366534e-07</td>
      <td>0.173440</td>
      <td>-2.4922</td>
      <td>0.998004</td>
      <td>0.000210</td>
      <td>0.996011</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">classifier</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">TSFreshFeatureExtractor</span><span class="p">(</span><span class="n">show_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">RandomForestClassifier</span><span class="p">())</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/travis/build/alan-turing-institute/sktime/sktime/transformers/series_as_features/summarize/_tsfresh.py:150: UserWarning: Found non-unique index, replaced with unique index.
  warn(&#34;Found non-unique index, replaced with unique index.&#34;)
Feature Extraction: 100%|██████████| 5/5 [00:22&lt;00:00,  4.58s/it]
/Users/travis/build/alan-turing-institute/sktime/sktime/transformers/series_as_features/summarize/_tsfresh.py:150: UserWarning: Found non-unique index, replaced with unique index.
  warn(&#34;Found non-unique index, replaced with unique index.&#34;)
Feature Extraction: 100%|██████████| 5/5 [00:07&lt;00:00,  1.52s/it]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.8113207547169812
</pre></div></div>
</div>
<p>What’s the implicit modelling choice here?</p>
<blockquote>
<div><p>Instead of working in the domain of the time series, we extract features from time series and choose to work in the domain of the features. Again, sometimes this works well, sometimes it doesn’t. The main difficulty is finding discriminative features for the classification problem.</p>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="Time-series-classification-with-sktime">
<h2>Time series classification with sktime<a class="headerlink" href="#Time-series-classification-with-sktime" title="Permalink to this headline">¶</a></h2>
<p>sktime has a number of specialised time series algorithms.</p>
<div class="section" id="Time-series-forest">
<h3>Time series forest<a class="headerlink" href="#Time-series-forest" title="Permalink to this headline">¶</a></h3>
<p>Time series forest is a modification of the random forest algorithm to the time series setting:</p>
<ol class="arabic simple">
<li><p>Split the series into multiple random intervals,</p></li>
<li><p>Extract features (mean, standard deviation and slope) from each interval,</p></li>
<li><p>Train a decision tree on the extracted features,</p></li>
<li><p>Ensemble steps 1 - 3.</p></li>
</ol>
<p>For more details, take a look at the <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0020025513001473">paper</a>.</p>
<p>In sktime, we can write:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sktime.transformers.series_as_features.summarize</span> <span class="kn">import</span> <span class="n">RandomIntervalFeatureExtractor</span>

<span class="n">steps</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;extract&#39;</span><span class="p">,</span> <span class="n">RandomIntervalFeatureExtractor</span><span class="p">(</span><span class="n">n_intervals</span><span class="o">=</span><span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">,</span> <span class="n">time_series_slope</span><span class="p">])),</span>
    <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">DecisionTreeClassifier</span><span class="p">())</span>
<span class="p">]</span>
<span class="n">time_series_tree</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To better understand the algorithm, we could write it in an even more modular way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">steps</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;segment&#39;</span><span class="p">,</span> <span class="n">RandomIntervalSegmenter</span><span class="p">(</span><span class="n">n_intervals</span><span class="o">=</span><span class="s1">&#39;sqrt&#39;</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="n">FeatureUnion</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">RowTransformer</span><span class="p">(</span><span class="n">FunctionTransformer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">RowTransformer</span><span class="p">(</span><span class="n">FunctionTransformer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span> <span class="n">RowTransformer</span><span class="p">(</span><span class="n">FunctionTransformer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">time_series_slope</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
    <span class="p">])),</span>
    <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">DecisionTreeClassifier</span><span class="p">())</span>
<span class="p">]</span>
<span class="n">time_series_tree</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
</pre></div>
</div>
<p>We can direclty fit and evaluate the single time series tree (which is simply a pipeline).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">time_series_tree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">time_series_tree</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.7924528301886793
</pre></div></div>
</div>
<p>For time series forest, we can simply use the single tree as the base estimator in the forest ensemble.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tsf</span> <span class="o">=</span> <span class="n">TimeSeriesForestClassifier</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">time_series_tree</span><span class="p">,</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;entropy&#39;</span><span class="p">,</span>
    <span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Fit and obtain the out-of-bag score:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tsf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="k">if</span> <span class="n">tsf</span><span class="o">.</span><span class="n">oob_score</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tsf</span><span class="o">.</span><span class="n">oob_score_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.8607594936708861
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tsf</span> <span class="o">=</span> <span class="n">TimeSeriesForestClassifier</span><span class="p">()</span>
<span class="n">tsf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">tsf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.8679245283018868
</pre></div></div>
</div>
<p>We can also obtain feature importances for the different features and intervals that the algorithms looked at and plot them in a feature importance graph over time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fi</span> <span class="o">=</span> <span class="n">tsf</span><span class="o">.</span><span class="n">feature_importances_</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figaspect</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">))</span>
<span class="n">fi</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Feature importance&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_02_classification_univariate_28_0.png" src="../_images/examples_02_classification_univariate_28_0.png" />
</div>
</div>
<div class="section" id="More-about-feature-importances">
<h4>More about feature importances<a class="headerlink" href="#More-about-feature-importances" title="Permalink to this headline">¶</a></h4>
<p>The feature importances method is based on the example showcased in <a class="reference external" href="https://arxiv.org/abs/1302.2277">this paper</a>.</p>
<p>In addition to the feature importances method <a class="reference external" href="https://scikit-learn.org/stable/auto_examples/ensemble/plot_forest_importances.html">available in scikit-learn</a>, our method collects the feature imporances values from each estimator for their respective intervals, calculates the sum of feature importances values on each timepoint, and normalises the values first by the number of estimators and then by the number of intervals.</p>
<p>As a result, the temporal importance curves can be plotted, as shown in the previous example.</p>
<p>Please note that this method currently supports only one particular structure of the tsf, where RandomIntervalFeatureExtractor() is used in the pipeline, or simply the default TimeSeriesForestClassifier() setting. For instance, two possible approaches could be:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Method 1: Default time-series forest classifier</span>
<span class="n">tsf1</span> <span class="o">=</span> <span class="n">TimeSeriesForestClassifier</span><span class="p">();</span>
<span class="n">tsf1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">);</span>
<span class="n">fi1</span> <span class="o">=</span> <span class="n">tsf1</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figaspect</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">));</span>
<span class="n">fi1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>

<span class="c1"># Method 2: Pipeline</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">,</span> <span class="n">time_series_slope</span><span class="p">];</span>
<span class="n">steps</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="n">RandomIntervalFeatureExtractor</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">)),</span>
         <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">DecisionTreeClassifier</span><span class="p">())];</span>
<span class="n">base_estimator</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="p">);</span>
<span class="n">tsf2</span> <span class="o">=</span> <span class="n">TimeSeriesForestClassifier</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_estimator</span><span class="p">);</span>
<span class="n">tsf2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">);</span>
<span class="n">fi2</span> <span class="o">=</span> <span class="n">tsf2</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figaspect</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">));</span>
<span class="n">fi2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_02_classification_univariate_30_0.png" src="../_images/examples_02_classification_univariate_30_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_02_classification_univariate_30_1.png" src="../_images/examples_02_classification_univariate_30_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="RISE">
<h3>RISE<a class="headerlink" href="#RISE" title="Permalink to this headline">¶</a></h3>
<p>Another popular variant of time series forest is the so-called Random Interval Spectral Ensemble (RISE), which makes use of several series-to-series feature extraction transformers, including:</p>
<ul class="simple">
<li><p>Fitted auto-regressive coefficients,</p></li>
<li><p>Estimated autocorrelation coefficients,</p></li>
<li><p>Power spectrum coefficients.</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">ar_coefs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">maxlag</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxlag</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">AutoReg</span><span class="p">(</span><span class="n">endog</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">acf_coefs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">maxlag</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">nlags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxlag</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">acf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="n">nlags</span><span class="p">,</span> <span class="n">fft</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">powerspectrum</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">fft</span><span class="o">.</span><span class="n">real</span> <span class="o">*</span> <span class="n">fft</span><span class="o">.</span><span class="n">real</span> <span class="o">+</span> <span class="n">fft</span><span class="o">.</span><span class="n">imag</span> <span class="o">*</span> <span class="n">fft</span><span class="o">.</span><span class="n">imag</span>
    <span class="k">return</span> <span class="n">ps</span><span class="p">[:</span><span class="n">ps</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The full pipeline of a single tree in RISE is then specified as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">steps</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;segment&#39;</span><span class="p">,</span> <span class="n">RandomIntervalSegmenter</span><span class="p">(</span><span class="n">n_intervals</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">5</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="n">FeatureUnion</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;ar&#39;</span><span class="p">,</span> <span class="n">RowTransformer</span><span class="p">(</span><span class="n">FunctionTransformer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">ar_coefs</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;acf&#39;</span><span class="p">,</span> <span class="n">RowTransformer</span><span class="p">(</span><span class="n">FunctionTransformer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">acf_coefs</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">,</span> <span class="n">RowTransformer</span><span class="p">(</span><span class="n">FunctionTransformer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">powerspectrum</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
    <span class="p">])),</span>
    <span class="p">(</span><span class="s1">&#39;tabularise&#39;</span><span class="p">,</span> <span class="n">Tabularizer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">DecisionTreeClassifier</span><span class="p">())</span>
<span class="p">]</span>
<span class="n">rise_tree</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>

<span class="n">rise</span> <span class="o">=</span> <span class="n">TimeSeriesForestClassifier</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">rise_tree</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">rise</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">rise</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[119 238]]
[[ 67 243]]
[[ 89 215]]
[[124 230]]
[[160 183]]
[[114 150]]
[[117 169]]
[[ 92 188]]
[[ 0 26]]
[[203 218]]
[[119 238]]
[[ 67 243]]
[[ 89 215]]
[[124 230]]
[[160 183]]
[[114 150]]
[[117 169]]
[[ 92 188]]
[[ 0 26]]
[[203 218]]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.7924528301886793
</pre></div></div>
</div>
</div>
<div class="section" id="K-nearest-neighbours-classifier-for-time-series">
<h3>K-nearest-neighbours classifier for time series<a class="headerlink" href="#K-nearest-neighbours-classifier-for-time-series" title="Permalink to this headline">¶</a></h3>
<p>For time series, the most popular k-nearest-neighbours algorithm is based on <a class="reference external" href="https://en.wikipedia.org/wiki/Dynamic_time_warping">dynamic time warping</a> (dtw) distance measure.</p>
<p><img alt="16e3b52010be42ce85b6b363765685c1" class="no-scaled-link" src="../_images/dtw.png" style="width: 500px;" /></p>
<p>Here we look at the <a class="reference external" href="http://www.timeseriesclassification.com/description.php?Dataset=BasicMotions">BasicMotions data set</a>. The data was generated as part of a student project where four students performed four activities whilst wearing a smart watch. The watch collects 3D accelerometer and a 3D gyroscope It consists of four classes, which are walking, resting, running and badminton. Participants were required to record motion a total of five times, and the data is sampled once every tenth of
a second, for a ten second period.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sktime.datasets</span> <span class="kn">import</span> <span class="n">load_basic_motions</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_basic_motions</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(60, 1) (60,) (20, 1) (20,)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">labels</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;badminton&#39; &#39;running&#39; &#39;standing&#39; &#39;walking&#39;] [13 15 16 16]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figaspect</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">))</span>
<span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
    <span class="n">X_train</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">y_train</span> <span class="o">==</span> <span class="n">label</span><span class="p">,</span> <span class="s2">&quot;dim_0&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Example time series&quot;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_02_classification_univariate_38_0.png" src="../_images/examples_02_classification_univariate_38_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figaspect</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">X_train</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">y_train</span> <span class="o">==</span> <span class="n">label</span><span class="p">,</span> <span class="s2">&quot;dim_0&quot;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Instances of </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_02_classification_univariate_39_0.png" src="../_images/examples_02_classification_univariate_39_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_02_classification_univariate_39_1.png" src="../_images/examples_02_classification_univariate_39_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
    <span class="n">Tabularizer</span><span class="p">(),</span>
    <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;euclidean&quot;</span><span class="p">))</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">knn</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.75
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sktime.classification.distance_based</span> <span class="kn">import</span> <span class="n">KNeighborsTimeSeriesClassifier</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsTimeSeriesClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;dtw&quot;</span><span class="p">)</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">knn</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.75
</pre></div></div>
</div>
</div>
<div class="section" id="Other-classifiers">
<h3>Other classifiers<a class="headerlink" href="#Other-classifiers" title="Permalink to this headline">¶</a></h3>
<p>To find out what other algorithms we have implemented in sktime, you can use our utility function:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sktime.utils</span> <span class="kn">import</span> <span class="n">all_estimators</span>
<span class="n">all_estimators</span><span class="p">(</span><span class="n">estimator_type</span><span class="o">=</span><span class="s2">&quot;classifier&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;BOSSEnsemble&#39;, sktime.classification.dictionary_based._boss.BOSSEnsemble),
 (&#39;BOSSIndividual&#39;,
  sktime.classification.dictionary_based._boss.BOSSIndividual),
 (&#39;ColumnEnsembleClassifier&#39;,
  sktime.classification.compose._column_ensemble.ColumnEnsembleClassifier),
 (&#39;ElasticEnsemble&#39;,
  sktime.classification.distance_based._elastic_ensemble.ElasticEnsemble),
 (&#39;IndividualTDE&#39;, sktime.classification.dictionary_based._tde.IndividualTDE),
 (&#39;KNeighborsTimeSeriesClassifier&#39;,
  sktime.classification.distance_based._time_series_neighbors.KNeighborsTimeSeriesClassifier),
 (&#39;MrSEQLClassifier&#39;,
  sktime.classification.shapelet_based.mrseql.mrseql.MrSEQLClassifier),
 (&#39;ProximityForest&#39;,
  sktime.classification.distance_based._proximity_forest.ProximityForest),
 (&#39;ProximityStump&#39;,
  sktime.classification.distance_based._proximity_forest.ProximityStump),
 (&#39;ProximityTree&#39;,
  sktime.classification.distance_based._proximity_forest.ProximityTree),
 (&#39;RandomIntervalSpectralForest&#39;,
  sktime.classification.frequency_based._rise.RandomIntervalSpectralForest),
 (&#39;ShapeletTransformClassifier&#39;,
  sktime.classification.shapelet_based._stc.ShapeletTransformClassifier),
 (&#39;TemporalDictionaryEnsemble&#39;,
  sktime.classification.dictionary_based._tde.TemporalDictionaryEnsemble),
 (&#39;TimeSeriesForest&#39;,
  sktime.classification.interval_based._tsf.TimeSeriesForest),
 (&#39;TimeSeriesForestClassifier&#39;,
  sktime.classification.compose._ensemble.TimeSeriesForestClassifier)]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Extra-resources">
<h2>Extra resources<a class="headerlink" href="#Extra-resources" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Multivariate-time-series-classification">
<h3>Multivariate time series classification<a class="headerlink" href="#Multivariate-time-series-classification" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>When you have multiple time series variables and want to learn the relationship between them and a label, you can take a look at our <a class="reference external" href="https://github.com/alan-turing-institute/sktime/blob/master/examples/03_classification_multivariate.ipynb">multivariate time series classification notebook</a>.</p></li>
</ul>
</div>
<div class="section" id="Cutting-edge-research-and-benchmarking">
<h3>Cutting-edge research and benchmarking<a class="headerlink" href="#Cutting-edge-research-and-benchmarking" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>For time-series classification data sets and Java-based methods, check out <a class="reference external" href="http://www.timeseriesclassification.com">timeseriesclassification.com</a></p></li>
<li><p>For a comparative benchmarking studies, check out</p>
<ul>
<li><p><a class="reference external" href="https://www.researchgate.net/profile/Anthony_Bagnall/publication/301856632_The_Great_Time_Series_Classification_Bake_Off_An_Experimental_Evaluation_of_Recently_Proposed_Algorithms_Extended_Version/links/579b580e08ae80bf6ea33d12.pdf">Bagnall, Anthony, et al. “The great time series classification bake off: a review and experimental evaluation of recent algorithmic advances.” Data Mining and Knowledge Discovery 31.3 (2017): 606-660.</a> and</p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/1809.04356">Fawaz, Hassan Ismail, et al. “Deep learning for time series classification: a review.” Data Mining and Knowledge Discovery 33.4 (2019): 917-963.</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="Deep-learning">
<h3>Deep learning<a class="headerlink" href="#Deep-learning" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>For deep-learning, check out sktime’s companion packages: <a class="reference external" href="https://github.com/sktime/sktime-dl">sktime-dl</a></p></li>
</ul>
</div>
<div class="section" id="Time-series-regression">
<h3>Time series regression<a class="headerlink" href="#Time-series-regression" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>sktime also supports time series regression, where the only difference is that the target variables is continuous and not discrete.</p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
<p>Generated by <a class="reference external" href="https://nbsphinx.readthedocs.io/">nbsphinx</a>. The Jupyter notebook file can be found <a class="reference external" href="https://github.com/alan-turing-institute/sktime/blob/master/examples/02_classification_univariate.ipynb">here</a>.</p>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019 - 2020, sktime developers (BSD-3-Clause License)

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>